<html>
    <head>
        <title>NANGLERNG COMMUNITY</title>
        {% load static %}
        <script src="{% static 'fontawesomefree/js/all.min.js' %}"></script>
        <link rel="stylesheet" type="text/css" href="{% static 'css/map.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/home.css' %}">   
        <link rel="stylesheet" type="text/css" href="{% static 'css/essay.css' %}">   
        <link rel="stylesheet" type="text/css" href="{% static 'css/timeline.css' %}">
        <link href="{% static 'fontawesomefree/css/all.min.css' %}" rel="stylesheet" type="text/css">        
        <link href="https://cdn.jsdelivr.net/gh/lazywasabi/thai-web-fonts@6/fonts/NotoSansThaiLooped/NotoSansThaiLooped.css" rel="stylesheet" />
        <style>
            @font-face {
                font-family: 'NeueBit';
                src: url("{% static 'css/fonts/NeueBit-Bold/NeueBit-Bold.woff2' %}") format('woff2');
                font-style: normal;
                font-display: swap;
            }

        </style>
        <script src="{% static 'js/toggle_menu.js' %}"></script>    
        <script>
            var map;
            function initMap() {                
                const nanglerng = { lat: 13.7591027, lng: 100.5099457 };

                map = new google.maps.Map(document.getElementById("map"), {
                    zoom: 15,
                    center: nanglerng,
                });
                               
                const image = "{% static 'images/marker.png' %}";
                var dataMarker = [];
                {% for loc in locations %}
                    dataMarker.push({
                        position:{ lat: {{loc.lat}}, lng: {{loc.lon}} },
                        label: "{{loc.title}}",
                        locId: {{loc.id}},
                    })
                {% endfor %}
                dataMarker.forEach(e=>{
                    const marker = new google.maps.Marker({
                        position: e.position,
                        map: map,
                        label:e.label,
                        icon: image,
                        locId: e.locId
                    });
                    marker.addListener("click", () => {
                        console.log(marker.locId);
                        window.location.assign("/community/map/"+marker.locId)
                    });
                })
                console.log("test");
            }    
        </script>    

    </head>
    <body>
        {% include "project/header.html" %} 
        {% block header %}{% endblock %}        
        <div id="content">
            <div class="community-tab-menu">                
                <div class="tab-comunity">
                    <ul class="menu-comunity">
                        <li class="menu-item tab-border "><a href="/community/essay">Our stories</a></li>
                        <li class="menu-item tab-border "><a href="/community/timeline">Timeline</a></li>
                        <li class="menu-item tab-border tab-active">Maps</li>
                    </ul>
                    <div class="spacer"></div>
                </div>
                <div class="tab-comunity-mini">
                    <div class="tab-com-mini-item tab-item-link"><a href="/community/essay">Our stories</a></div>
                    <div class="tab-com-mini-item tab-item-link"><a href="/community/timeline">Timeline</a></div>
                    <div class="tab-com-mini-item ">Maps</div>
                </div>
            </div>
            <div>                
                <div id="content-text">
                    <div id="left-column">                        
                        <div>รายการสถานที่</div>                        
                        <ul class="event">                            
                            {% for loc in locations %}
                            <li class="event-item"><a href="map/{{loc.id}}">{{loc.title}}</a></li>                            
                            {% endfor %}
                        </ul>                        
                    </div>
                    <div id="center-right-column">                        
                        <div class="slide">
                            <div id="map"></div>
                            <script
                                src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCy41h4x-3qDCWMMH7QDST4Xm2VQJVKd7o&callback=initMap&libraries=&v=weekly"
                                async
                            ></script>
                        </div>
                    </div>                    
                </div>
            </div>   
            <div id="footer">
                {% include "project/footer.html" %} 
                {% block footer %}{% endblock %}
            </div>
            <div id="list-map">
                <div class="list-event">
                    <a href="#" onclick="showListMap()">
                        Directory
                        <div class="arrow-up"><i class="fa-solid fa-angle-up"></i></div>
                    </a>
                </div>
            </div>
        </div>
        <div id="list-map-menu" class="mini-menu">
            <div class="head-mini-menu">
                <a class ="btn-close link-mini" href="#" onclick="hidePopupListMap()">
                    <i class="fa-solid fa-xmark"></i>
                </a>
            </div>
            <div class="event-link-list-mini">
                <div>รายการสถานที่</div>                        
                <ul class="event">                            
                    {% for loc in locations %}
                    <li class="event-item-mini"><a href="map/{{loc.id}}">{{loc.title}}</a></li>                            
                    {% endfor %}
                </ul>
            </div>
        </div>
    </body>
</html>

